<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
  div { padding: 0 0 0 0; margin: 0 0 0 0; box-sizing: border-box; }
  #slave { 
    outline: 1px solid black;  position: absolute; }
  #master { outline: 1px solid black; height: 72px; width: 72px;  background: seagreen; border-radius: 72px; position: absolute }
  </style>
</head>
<body>
 
<div id="master"></div> 

<script src="app.js"></script>  


<script>
var log = console.log;
var master_radius = 72 / 2;
var slave_radius = 72 / 2;
var master = document.getElementById('master').style;
master.top = window.innerHeight / 2 -master_radius + "px";
master.left = window.innerWidth / 2 - master_radius + "px";


var slaveCircle = {

  me: null,
  radius: 0,
  origin: {
    x: window.innerWidth / 2 - this.radius,
    y: window.innerHeight / 2 - this.radius 
  },
  masterCircleRadius: 0,
  init: function(radius, masterCircleRadius) {
      this.me = document.createElement('div');
      this.radius = radius;      
      this.origin.x = window.innerWidth / 2 - radius;
      this.origin.y = window.innerHeight / 2 - radius;
      this.masterCircleRadius = masterCircleRadius;

      this.me.style.height = radius * 2 +  'px'; 
      this.me.style.width = radius * 2  +  'px'; 
      this.me.style.borderRadius = radius +  'px';
      this.me.style.backgroundColor = "coral";
      this.me.style.left = this.origin.x + 'px';
      this.me.style.top = this.origin.y + 'px';
      this.me.style.position = 'absolute';
      this.me.id = 'slave';
      
      document.body.appendChild(this.me);      
  },
  isCircleHit: function(evt) {      
      return (evt.target == this.me);
  },
  moveCircle: function(evt) {
    log(evt.x, evt.y);
    this.me.style.left = evt.x - this.radius + 'px';
    this.me.style.top = evt.y - this.radius + 'px';
  },
  returnHome: function(evt) {
    // if (evt.x === this.origin.x && evt.y === this.origin.y) return false;

    var pathBackX = evt.x,
        pathBackY = evt.y;

    var isToTheLeft = (evt.x < this.origin.x);
    var isAbove = (evt.y < this.origin.y);
    this._translate(this.me, this.origin.x, this.origin.y+this.masterCircleRadius*2-4);

    
     log('x: ' + evt.x + ', ' + this.origin.x);
     log('y: ' + evt.y + ', ' + this.origin.y);
  },
  
_translate: function( elem, x, y ) {
    var left = parseInt( this._css( elem, 'left' ), 10 ),
        top = parseInt( this._css( elem, 'top' ), 10 ),
        // Calculate distance to the origin.
        dx = left - x,
        dy = top - y,
        i = 1,
        count = 20,
        delay = 25;
    
    function loop() {
        if ( i >= count ) { return; }
        if (true) { }
        i += 1;
        log('xDelta: ' + ( dx * i / count  ).toFixed( 0 ));
        elem.style.left = ( left - ( dx * i / count ) ).toFixed( 0 ) + 'px';
        elem.style.top = ( top - ( dy * i / count ) ).toFixed( 0 ) + 'px';
        setTimeout( loop, delay );
    }
    
    loop();
  },

 _css: function( element, property ) {
    return window.getComputedStyle( element, null ).getPropertyValue( property );
  } 
}


// Logic
window.addEventListener("load", function() {

  slaveCircle.init(30, 36);

  function wrapper (e) {
            slaveCircle.moveCircle(e);
          };

  document.addEventListener('mousedown', function(e) {     

      // Follow the cursor if mouse click hit the circle
      if (slaveCircle.isCircleHit(e)) {
          document.addEventListener('mousemove', wrapper)
      }
  });

  document.addEventListener('mouseup', function(e) { 
        document.removeEventListener('mousemove', wrapper);
        slaveCircle.returnHome(e);
  });

  
element = document.getElementById('slave');
}); // init

var element;

// window.onclick = function ( e ) {
//     var arr;
    
//     if ( e.target.nodeName === 'BUTTON' ) {
//         arr = e.target.title.split( ' ' );
//         translate( img, +arr[0], +arr[1] );        
//     }
// };





// var slave = document.getElementById('slave');
// var slave_original_pos_y = window.innerHeight / 2 - slave_radius + "px";
// var slave_original_pos_x = window.innerWidth / 2 - slave_radius + "px";
// slave.style.top = slave_original_pos_y;
// slave.style.left = slave_original_pos_x;



// slave.addEventListener("mousedown", (e, trackMouse) => {
  
//   function trackMouse(e) {    
//     this.style.top = e.y - slave_radius + "px"; 
//     this.style.left =  e.x - slave_radius + "px";  
// }


//   // Start dragging
//   slave.addEventListener("mousemove", trackMouse);

//   // Stop dragging
//   slave.addEventListener("mouseup", (e) => {    
//     slave.removeEventListener("mousemove", trackMouse);

//     slave.style.left = slave_original_pos_x;
//     slave.style.top = slave_original_pos_y;
//   });


// });

  



</script>
</body>
</html>